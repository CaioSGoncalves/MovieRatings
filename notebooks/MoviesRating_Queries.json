{"paragraphs":[{"text":"sc","user":"anonymous","dateUpdated":"2020-01-30T00:23:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","title":"string","ratings_count":"string","ratings_mean":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res2: org.apache.spark.SparkContext = org.apache.spark.SparkContext@3e2ab276\n"}]},"apps":[],"jobName":"paragraph_1580342571669_1861584327","id":"20200126-233112_676234288","dateCreated":"2020-01-30T00:02:51+0000","dateStarted":"2020-01-30T00:23:45+0000","dateFinished":"2020-01-30T00:23:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:54"},{"text":"%pyspark\nmovies = spark.read.format('delta').load(\"gs://teste-caio/movie_ratings/delta/movies\")\nmovies.registerTempTable(\"movies\")","user":"anonymous","dateUpdated":"2020-01-30T00:23:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580343809524_-697629746","id":"20200130-002329_875992878","dateCreated":"2020-01-30T00:23:29+0000","dateStarted":"2020-01-30T00:23:48+0000","dateFinished":"2020-01-30T00:23:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:55"},{"text":"%pyspark\nratings = spark.read.format('delta').load(\"gs://teste-caio/movie_ratings/delta/ratings\")\nratings.registerTempTable(\"ratings\")","user":"anonymous","dateUpdated":"2020-01-30T00:24:15+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"movieId","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"title","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"ratings_count","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"ratings_mean","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"movieId":"string","title":"string","ratings_count":"string","ratings_mean":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580342571672_449927316","id":"20200126-233032_1314739010","dateCreated":"2020-01-30T00:02:51+0000","dateStarted":"2020-01-30T00:24:15+0000","dateFinished":"2020-01-30T00:24:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"text":"%pyspark\nmost_rated_movies_query = \"\"\"\nSELECT m.movieId, m.title, COUNT(r.rating) as ratings_count, MEAN(r.rating) as ratings_mean\nFROM ratings as r\nINNER JOIN movies as m on m.movieID = r.movieID\nGROUP BY m.movieID, m.title\nORDER BY ratings_count DESC\nLIMIT 1000 \n\"\"\"\nmost_rated_movies = spark.sql(most_rated_movies_query)\nmost_rated_movies.registerTempTable(\"most_rated_movies\")","user":"anonymous","dateUpdated":"2020-01-30T00:24:44+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580342571672_1273266662","id":"20200126-233223_1255344798","dateCreated":"2020-01-30T00:02:51+0000","dateStarted":"2020-01-30T00:24:44+0000","dateFinished":"2020-01-30T00:24:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"text":"%sql\nSELECT * FROM most_rated_movies\nORDER BY ratings_mean DESC\nLIMIT 100","user":"anonymous","dateUpdated":"2020-01-30T00:25:53+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movieId":"string","title":"string","ratings_count":"string","ratings_mean":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"movieId\ttitle\tratings_count\tratings_mean\n318\tShawshank Redemption, The (1994)\t97999\t4.424188001918387\n858\tGodfather, The (1972)\t60904\t4.332892749244713\n50\tUsual Suspects, The (1995)\t62180\t4.291958829205532\n1221\tGodfather: Part II, The (1974)\t38875\t4.2630353697749195\n527\tSchindler's List (1993)\t71516\t4.257501817775044\n2019\tSeven Samurai (Shichinin no samurai) (1954)\t14578\t4.2541157909178215\n1203\t12 Angry Men (1957)\t17931\t4.237075455914338\n904\tRear Window (1954)\t22264\t4.230798598634567\n2959\tFight Club (1999)\t65678\t4.230663235786717\n1193\tOne Flew Over the Cuckoo's Nest (1975)\t42181\t4.222920272160452\n912\tCasablanca (1942)\t31095\t4.210098086509085\n750\tDr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1964)\t29484\t4.208876000542667\n5618\tSpirited Away (Sen to Chihiro no kamikakushi) (2001)\t23227\t4.2076678004047015\n1212\tThird Man, The (1949)\t7980\t4.20375939849624\n908\tNorth by Northwest (1959)\t19613\t4.201091113037271\n44555\tLives of Others, The (Das leben der Anderen) (2006)\t9670\t4.199844881075491\n922\tSunset Blvd. (a.k.a. Sunset Boulevard) (1950)\t8264\t4.195425943852856\n6016\tCity of God (Cidade de Deus) (2002)\t21558\t4.184896558122275\n1213\tGoodfellas (1990)\t35934\t4.177603383981745\n296\tPulp Fiction (1994)\t92406\t4.173971387139363\n58559\tDark Knight, The (2008)\t44741\t4.173755615654545\n2324\tLife Is Beautiful (La Vita è bella) (1997)\t26995\t4.163178366364141\n79132\tInception (2010)\t41475\t4.1629897528631705\n4226\tMemento (2000)\t43739\t4.153844395162213\n1207\tTo Kill a Mockingbird (1962)\t17988\t4.153380031131865\n1252\tChinatown (1974)\t19084\t4.1524313561098305\n593\tSilence of the Lambs, The (1991)\t87899\t4.15141241652351\n2571\tMatrix, The (1999)\t84545\t4.149695428470046\n5971\tMy Neighbor Totoro (Tonari no Totoro) (1988)\t9767\t4.148407904167093\n1136\tMonty Python and the Holy Grail (1975)\t40866\t4.14835070718935\n1234\tSting, The (1973)\t17906\t4.141628504411929\n2329\tAmerican History X (1998)\t34110\t4.1408824391674\n1196\tStar Wars: Episode V - The Empire Strikes Back (1980)\t65822\t4.133481206891313\n913\tMaltese Falcon, The (1941)\t14585\t4.132430579362358\n112552\tWhiplash (2014)\t10907\t4.127807829834052\n92259\tIntouchables (2011)\t13573\t4.127532601488249\n1148\tWallace & Gromit: The Wrong Trousers (1993)\t17337\t4.1275307146565146\n1197\tPrincess Bride, The (1987)\t42878\t4.124807593637763\n3000\tPrincess Mononoke (Mononoke-hime) (1997)\t13865\t4.124125495852867\n1172\tCinema Paradiso (Nuovo cinema Paradiso) (1989)\t11452\t4.123428222144604\n2858\tAmerican Beauty (1999)\t60820\t4.121506083525156\n1198\tRaiders of the Lost Ark (Indiana Jones and the Raiders of the Lost Ark) (1981)\t63505\t4.120455082276986\n260\tStar Wars: Episode IV - A New Hope (1977)\t81815\t4.120454684348836\n1201\tGood, the Bad and the Ugly, The (Buono, il brutto, il cattivo, Il) (1966)\t19731\t4.120419644214688\n48516\tDeparted, The (2006)\t26162\t4.119620059628469\n903\tVertigo (1958)\t17926\t4.119519134218454\n4973\tAmelie (Fabuleux destin d'Amélie Poulain, Le) (2001)\t37167\t4.1172545537708185\n541\tBlade Runner (1982)\t39441\t4.116097462031895\n1204\tLawrence of Arabia (1962)\t15415\t4.113104119364255\n898\tPhiladelphia Story, The (1940)\t7828\t4.109989780275932\n745\tWallace & Gromit: A Close Shave (1995)\t13866\t4.109151882302034\n1208\tApocalypse Now (1979)\t28986\t4.107086179534948\n608\tFargo (1996)\t54500\t4.106229357798165\n1233\tBoot, Das (Boat, The) (1981)\t15936\t4.105923694779117\n7153\tLord of the Rings: The Return of the King, The (2003)\t57378\t4.102853009864408\n1262\tGreat Escape, The (1963)\t12748\t4.101113900219643\n4993\tLord of the Rings: The Fellowship of the Ring, The (2001)\t61883\t4.0979428922321155\n109487\tInterstellar (2014)\t23081\t4.092868593215199\n1089\tReservoir Dogs (1992)\t37331\t4.089496664970132\n923\tCitizen Kane (1941)\t21512\t4.088136853849014\n1267\tManchurian Candidate, The (1962)\t10294\t4.0879152904604625\n293\tLéon: The Professional (a.k.a. The Professional) (Léon) (1994)\t36504\t4.087593140477756\n48780\tPrestige, The (2006)\t23132\t4.0875410686494895\n111\tTaxi Driver (1976)\t32885\t4.086422381024783\n1250\tBridge on the River Kwai, The (1957)\t14701\t4.082919529283722\n31658\tHowl's Moving Castle (Hauru no ugoku shiro) (2004)\t10646\t4.081579936126245\n1276\tCool Hand Luke (1967)\t13339\t4.077929380013495\n1704\tGood Will Hunting (1997)\t42769\t4.076387102808109\n5952\tLord of the Rings: The Two Towers, The (2002)\t56696\t4.074705446592352\n7361\tEternal Sunshine of the Spotless Mind (2004)\t35064\t4.073479922427561\n47\tSeven (a.k.a. Se7en) (1995)\t55240\t4.071687183200579\n27773\tOld Boy (2003)\t12152\t4.07093482554312\n4011\tSnatch (2000)\t26552\t4.065155167219042\n1225\tAmadeus (1984)\t23768\t4.064267081790643\n1617\tL.A. Confidential (1997)\t32553\t4.06361932847971\n1219\tPsycho (1960)\t24234\t4.061855244697532\n800\tLone Star (1996)\t7567\t4.059997356944628\n969\tAfrican Queen, The (1951)\t11937\t4.059646477339365\n916\tRoman Holiday (1953)\t7459\t4.057849577691379\n1299\tKilling Fields, The (1984)\t8052\t4.057252856433184\n306\tThree Colors: Red (Trois couleurs: Rouge) (1994)\t8470\t4.05702479338843\n356\tForrest Gump (1994)\t97040\t4.056584913437757\n2028\tSaving Private Ryan (1998)\t54027\t4.05053029041035\n1214\tAlien (1979)\t39282\t4.05020110992312\n1228\tRaging Bull (1980)\t11824\t4.048756765899864\n5995\tPianist, The (2002)\t18209\t4.044456038222857\n134130\tThe Martian (2015)\t16160\t4.043811881188119\n1222\tFull Metal Jacket (1987)\t27809\t4.039537559782804\n1230\tAnnie Hall (1977)\t19355\t4.03722552312064\n720\tWallace & Gromit: The Best of Aardman Animation (1996)\t9674\t4.035145751498863\n1247\tGraduate, The (1967)\t20769\t4.033776301218162\n910\tSome Like It Hot (1959)\t13753\t4.0312295499163815\n1304\tButch Cassidy and the Sundance Kid (1969)\t17838\t4.031169413611392\n3147\tGreen Mile, The (1999)\t33140\t4.025558237779119\n899\tSingin' in the Rain (1952)\t12794\t4.02520712834141\n1244\tManhattan (1979)\t10249\t4.024538979412625\n68237\tMoon (2009)\t10935\t4.02085048010974\n164179\tArrival (2016)\t8682\t4.019926284266298\n2542\tLock, Stock & Two Smoking Barrels (1998)\t20843\t4.018591373602648\n116797\tThe Imitation Game (2014)\t15916\t4.017623774817793\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1580342571672_799592474","id":"20200126-233342_745820783","dateCreated":"2020-01-30T00:02:51+0000","dateStarted":"2020-01-30T00:25:53+0000","dateFinished":"2020-01-30T00:26:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"text":"%pyspark\nmost_and_better_rated_movies_query = \"\"\"\nSELECT * FROM most_rated_movies\nORDER BY ratings_mean DESC\nLIMIT 100\n\"\"\"\nfrom datetime import date\nmost_and_better_rated_movies = spark.sql(most_and_better_rated_movies_query)\nmost_and_better_rated_movies.write.json(f\"gs://teste-caio/movie_ratings/output/movie_ratings_daily/{str(date.today())}.json\")","user":"anonymous","dateUpdated":"2020-01-30T00:26:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580342571673_-1966926419","id":"20200126-233349_1155445708","dateCreated":"2020-01-30T00:02:51+0000","dateStarted":"2020-01-30T00:26:13+0000","dateFinished":"2020-01-30T00:26:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-01-30T00:02:51+0000","config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1580342571674_45898137","id":"20200128-042556_2049123224","dateCreated":"2020-01-30T00:02:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:60"}],"name":"MoviesRating_Queries","id":"2EZ551TMN","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}