{"paragraphs":[{"text":"sc","user":"anonymous","dateUpdated":"2020-02-01T16:25:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res2: org.apache.spark.SparkContext = org.apache.spark.SparkContext@25843056\n"}]},"apps":[],"jobName":"paragraph_1580572138956_1930299894","id":"20200131-004923_1753034178","dateCreated":"2020-02-01T15:48:58+0000","dateStarted":"2020-02-01T16:25:54+0000","dateFinished":"2020-02-01T16:25:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5627"},{"text":"%pyspark\n# READING STREAMING DATA FROM KAFKA\ndf = spark \\\n  .readStream \\\n  .format(\"kafka\") \\\n  .option(\"kafka.bootstrap.servers\", \"10.158.0.57:9092\") \\\n  .option(\"subscribe\", \"movieRatings\") \\\n  .load()","user":"anonymous","dateUpdated":"2020-02-01T17:25:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580572138962_891784987","id":"20200131-005045_848093629","dateCreated":"2020-02-01T15:48:58+0000","dateStarted":"2020-02-01T16:32:18+0000","dateFinished":"2020-02-01T16:32:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5628"},{"text":"%pyspark\nfrom pyspark.sql.types import *\n# SETTING SCHEMA AND FORMATTING STREAMING DATA\n\nschema = StructType([ \n                        StructField(\"userId\", IntegerType(), True),\n                        StructField(\"movieId\", StringType(), True),\n                        StructField(\"rating\", FloatType(), True),\n                        StructField(\"timestamp\", FloatType(), True)\n                    ])\n                        \ndata = df.selectExpr(\"CAST(value AS STRING)\")\\\n        .select(from_json(\"value\", schema).alias(\"data\")).select(\"data.*\")\n","user":"anonymous","dateUpdated":"2020-02-01T19:14:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580572138963_1677475668","id":"20200131-012502_1483452983","dateCreated":"2020-02-01T15:48:58+0000","dateStarted":"2020-02-01T16:32:23+0000","dateFinished":"2020-02-01T16:32:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5629"},{"text":"%pyspark\n# WRITING STREAMING DATA TO DELTA LAKE\n( data\n    .writeStream\n    .format(\"delta\")\n    .outputMode(\"append\")\n    .option(\"checkpointLocation\", \"gs://teste-caio/movie_ratings/delta/ratings/_checkpoints/etl-from-kafka\")\n    .start(\"gs://teste-caio/movie_ratings/delta/ratings\") )","user":"anonymous","dateUpdated":"2020-02-01T17:26:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.streaming.StreamingQuery object at 0x7f6f82e454a8>\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-fb19-m.southamerica-east1-a.c.sincere-bongo-264115.internal:4040/jobs/job?id=167"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1580572138963_-1788053622","id":"20200131-014916_694833715","dateCreated":"2020-02-01T15:48:58+0000","dateStarted":"2020-02-01T17:23:39+0000","dateFinished":"2020-02-01T17:23:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5630"},{"text":"%pyspark\n# READ FROM DELTA LAKE\nratings = spark.read.format('delta').load(\"gs://teste-caio/movie_ratings/delta/ratings\")\nratings.count()\n# 27.753.444","user":"anonymous","dateUpdated":"2020-02-01T21:07:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"21\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://cluster-fb19-m.southamerica-east1-a.c.sincere-bongo-264115.internal:4040/jobs/job?id=209","http://cluster-fb19-m.southamerica-east1-a.c.sincere-bongo-264115.internal:4040/jobs/job?id=210","http://cluster-fb19-m.southamerica-east1-a.c.sincere-bongo-264115.internal:4040/jobs/job?id=211"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1580572138964_-757834698","id":"20200131-021208_1640517312","dateCreated":"2020-02-01T15:48:58+0000","dateStarted":"2020-02-01T21:07:14+0000","dateFinished":"2020-02-01T21:07:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5631"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-02-01T16:42:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1580575360017_722240740","id":"20200201-164240_1274773900","dateCreated":"2020-02-01T16:42:40+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5632"}],"name":"MoviesRating_KafkaIngestion","id":"2F1P5TQW1","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}